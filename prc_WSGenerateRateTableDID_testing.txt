SET @p_jobId = 461;
SET @p_RateGeneratorId = 6;
SET @p_RateTableId = -1 ;
SET @p_rateTableName = '_TST_231219';
SET @p_EffectiveDate = '2019-12-23';
SET @p_delete_exiting_rate = 1;
SET @p_EffectiveRate = 'now';
SET @p_ModifiedBy		= '_TST_231219';

call prc_WSGenerateRateTableDID_TEST( @p_jobId , @p_RateGeneratorId , @p_RateTableId , @p_rateTableName , @p_EffectiveDate , @p_delete_exiting_rate ,  @p_EffectiveRate ,  @p_ModifiedBy );
-- select sum(Total) from tmp_table_output_1 GROUP BY VendorConnectionID, Code, AccessType ,CountryID ,City ,Tariff ;


SET @p_jobId = 461;
SET @p_RateGeneratorId = 5;
SET @p_RateTableId = -1 ;
SET @p_rateTableName = '_TST_201219';
SET @p_EffectiveDate = '2019-12-20';
SET @p_delete_exiting_rate = 1;
SET @p_EffectiveRate = 'now';
SET @p_ModifiedBy		= '_TST_201219';

-- call prc_WSGenerateRateTableDID( @p_jobId , @p_RateGeneratorId , @p_RateTableId , @p_rateTableName , @p_EffectiveDate , @p_delete_exiting_rate ,  @p_EffectiveRate ,  @p_ModifiedBy );
-- CALL prc_WSGenerateRateTableDID(614,5,202,'','2019-12-19',1,'now','Onno Westra')  





+-------------+-------------+---------------+------------+-----------+---------------------+---------------+------+------------+-------+-----------------+--------------------+----------+---------+------------+-------------+-------------+---------------+------------------+--------------------+-------------------+---------------------+------------+------------+----------------------+--------------------------+---------------------------+--------------------+---------------------+---------------------+-----------------------+--------------------------+----------------------------+---------------------------+-----------------------------+--------------------+--------------------+------------------------------+-----------------------------------+----------------+-----------------+-----------------+-------------------+----------------------+------------------------+-----------------------+-------------------------+----------------+----------------+--------------------------+------------------------------+-------------------------------+------------------------------+-------------------------------+-------------------------------+---------------------------------+------------------------------------+--------------------------------------+-------------------------------------+---------------------------------------+------------------------------+------------------------------+----------------------------------------+--------------------------------------------+---------------------------------------------+
| RateTableID | TimezonesID | TimezoneTitle | CodeDeckId | CountryID | AccessType          | CountryPrefix | City | Tariff     | Code  | OriginationCode | VendorConnectionID | VendorID | EndDate | OneOffCost | MonthlyCost | CostPerCall | CostPerMinute | SurchargePerCall | SurchargePerMinute | OutpaymentPerCall | OutpaymentPerMinute | Surcharges | Chargeback | CollectionCostAmount | CollectionCostPercentage | RegistrationCostPerNumber | OneOffCostCurrency | MonthlyCostCurrency | CostPerCallCurrency | CostPerMinuteCurrency | SurchargePerCallCurrency | SurchargePerMinuteCurrency | OutpaymentPerCallCurrency | OutpaymentPerMinuteCurrency | SurchargesCurrency | ChargebackCurrency | CollectionCostAmountCurrency | RegistrationCostPerNumberCurrency | new_OneOffCost | new_MonthlyCost | new_CostPerCall | new_CostPerMinute | new_SurchargePerCall | new_SurchargePerMinute | new_OutpaymentPerCall | new_OutpaymentPerMinute | new_Surcharges | new_Chargeback | new_CollectionCostAmount | new_CollectionCostPercentage | new_RegistrationCostPerNumber | MarginRuleApplied_OneOffCost | MarginRuleApplied_MonthlyCost | MarginRuleApplied_CostPerCall | MarginRuleApplied_CostPerMinute | MarginRuleApplied_SurchargePerCall | MarginRuleApplied_SurchargePerMinute | MarginRuleApplied_OutpaymentPerCall | MarginRuleApplied_OutpaymentPerMinute | MarginRuleApplied_Surcharges | MarginRuleApplied_Chargeback | MarginRuleApplied_CollectionCostAmount | MarginRuleApplied_CollectionCostPercentage | MarginRuleApplied_RegistrationCostPerNumber |
+-------------+-------------+---------------+------------+-----------+---------------------+---------------+------+------------+-------+-----------------+--------------------+----------+---------+------------+-------------+-------------+---------------+------------------+--------------------+-------------------+---------------------+------------+------------+----------------------+--------------------------+---------------------------+--------------------+---------------------+---------------------+-----------------------+--------------------------+----------------------------+---------------------------+-----------------------------+--------------------+--------------------+------------------------------+-----------------------------------+----------------+-----------------+-----------------+-------------------+----------------------+------------------------+-----------------------+-------------------------+----------------+----------------+--------------------------+------------------------------+-------------------------------+------------------------------+-------------------------------+-------------------------------+---------------------------------+------------------------------------+--------------------------------------+-------------------------------------+---------------------------------------+------------------------------+------------------------------+----------------------------------------+--------------------------------------------+---------------------------------------------+
| 141         | 1           | Default       | 4          | 67        | Premium Rate Number | 32            |      | 2 per call | 32905 | FIX             | 44                 | 26       |         | 0.00000000 | 0.00000000  | 0.29000000  | 0.00000000    | 0.00000000       | 0.00000000         | 1.65289300        | 0.00000000          | 0.00000000 | 0.00000000 | 0.00000000           | 0.00000000               | 0.00000000                | 9                  | 9                   | 9                   | 9                     | 9                        | 9                          | 9                         | 9                           | 9                  | 9                  | 9                            | 9                                 |                |                 |                 |                   |                      |                        |                       |                         |                |                |                          |                              |                               |                              |                               |                               |                                 |                                    |                                      |                                     |                                       |                              |                              |                                        |                                            |                                             |
+-------------+-------------+---------------+------------+-----------+---------------------+---------------+------+------------+-------+-----------------+--------------------+----------+---------+------------+-------------+-------------+---------------+------------------+--------------------+-------------------+---------------------+------------+------------+----------------------+--------------------------+---------------------------+--------------------+---------------------+---------------------+-----------------------+--------------------------+----------------------------+---------------------------+-----------------------------+--------------------+--------------------+------------------------------+-----------------------------------+----------------+-----------------+-----------------+-------------------+----------------------+------------------------+-----------------------+-------------------------+----------------+----------------+--------------------------+------------------------------+-------------------------------+------------------------------+-------------------------------+-------------------------------+---------------------------------+------------------------------------+--------------------------------------+-------------------------------------+---------------------------------------+------------------------------+------------------------------+----------------------------------------+--------------------------------------------+---------------------------------------------+
| 141         | 10          | Off Peak      | 4          | 67        | Premium Rate Number | 32            |      | 2 per call | 32905 | FIX             | 44                 | 26       |         | 0.00000000 | 0.00000000  | 0.00000000  | 0.02340000    | 0.00000000       | 0.00000000         | 0.00000000        | 0.00000000          | 0.00000000 | 0.00000000 | 0.00000000           | 0.00000000               | 0.00000000                | 9                  | 9                   | 9                   | 9                     | 9                        | 9                          | 9                         | 9                           | 9                  | 9                  | 9                            | 9                                 |                |                 |                 |                   |                      |                        |                       |                         |                |                |                          |                              |                               |                              |                               |                               |                                 |                                    |                                      |                                     |                                       |                              |                              |                                        |                                            |                                             |
+-------------+-------------+---------------+------------+-----------+---------------------+---------------+------+------------+-------+-----------------+--------------------+----------+---------+------------+-------------+-------------+---------------+------------------+--------------------+-------------------+---------------------+------------+------------+----------------------+--------------------------+---------------------------+--------------------+---------------------+---------------------+-----------------------+--------------------------+----------------------------+---------------------------+-----------------------------+--------------------+--------------------+------------------------------+-----------------------------------+----------------+-----------------+-----------------+-------------------+----------------------+------------------------+-----------------------+-------------------------+----------------+----------------+--------------------------+------------------------------+-------------------------------+------------------------------+-------------------------------+-------------------------------+---------------------------------+------------------------------------+--------------------------------------+-------------------------------------+---------------------------------------+------------------------------+------------------------------+----------------------------------------+--------------------------------------------+---------------------------------------------+
| 141         | 13          | Peak          | 4          | 67        | Premium Rate Number | 32            |      | 2 per call | 32905 | FIX             | 44                 | 26       |         | 0.00000000 | 0.00000000  | 0.00000000  | 0.03560000    | 0.00000000       | 0.00000000         | 0.00000000        | 0.00000000          | 0.00000000 | 0.00000000 | 0.00000000           | 0.00000000               | 0.00000000                | 9                  | 9                   | 9                   | 9                     | 9                        | 9                          | 9                         | 9                           | 9                  | 9                  | 9                            | 9                                 |                |                 |                 |                   |                      |                        |                       |                         |                |                |                          |                              |                               |                              |                               |                               |                                 |                                    |                                      |                                     |                                       |                              |                              |                                        |                                            |                                             |
+-------------+-------------+---------------+------------+-----------+---------------------+---------------+------+------------+-------+-----------------+--------------------+----------+---------+------------+-------------+-------------+---------------+------------------+--------------------+-------------------+---------------------+------------+------------+----------------------+--------------------------+---------------------------+--------------------+---------------------+---------------------+-----------------------+--------------------------+----------------------------+---------------------------+-----------------------------+--------------------+--------------------+------------------------------+-----------------------------------+----------------+-----------------+-----------------+-------------------+----------------------+------------------------+-----------------------+-------------------------+----------------+----------------+--------------------------+------------------------------+-------------------------------+------------------------------+-------------------------------+-------------------------------+---------------------------------+------------------------------------+--------------------------------------+-------------------------------------+---------------------------------------+------------------------------+------------------------------+----------------------------------------+--------------------------------------------+---------------------------------------------+
| 141         | 1           | Default       | 4          | 67        | Premium Rate Number | 32            |      | 2 per call | 32905 | MOB             | 44                 | 26       |         | 0.00000000 | 0.00000000  | 0.42000000  | 0.16000000    | 0.00000000       | 0.00000000         | 1.65289300        | 0.00000000          | 0.00000000 | 0.00000000 | 0.00000000           | 0.00000000               | 0.00000000                | 9                  | 9                   | 9                   | 9                     | 9                        | 9                          | 9                         | 9                           | 9                  | 9                  | 9                            | 9                                 |                |                 |                 |                   |                      |                        |                       |                         |                |                |                          |                              |                               |                              |                               |                               |                                 |                                    |                                      |                                     |                                       |                              |                              |                                        |                                            |                                             |
+-------------+-------------+---------------+------------+-----------+---------------------+---------------+------+------------+-------+-----------------+--------------------+----------+---------+------------+-------------+-------------+---------------+------------------+--------------------+-------------------+---------------------+------------+------------+----------------------+--------------------------+---------------------------+--------------------+---------------------+---------------------+-----------------------+--------------------------+----------------------------+---------------------------+-----------------------------+--------------------+--------------------+------------------------------+-----------------------------------+----------------+-----------------+-----------------+-------------------+----------------------+------------------------+-----------------------+-------------------------+----------------+----------------+--------------------------+------------------------------+-------------------------------+------------------------------+-------------------------------+-------------------------------+---------------------------------+------------------------------------+--------------------------------------+-------------------------------------+---------------------------------------+------------------------------+------------------------------+----------------------------------------+--------------------------------------------+---------------------------------------------+
| 141         | 1           | Default       | 4          | 67        | Premium Rate Number | 32            |      | 2 per call | 32905 | PAY             | 44                 | 26       |         | 0.00000000 | 0.00000000  | 0.29000000  | 0.00000000    | 0.00000000       | 0.00000000         | 1.65289300        | 0.00000000          | 0.00000000 | 0.00000000 | 0.00000000           | 0.00000000               | 0.00000000                | 9                  | 9                   | 9                   | 9                     | 9                        | 9                          | 9                         | 9                           | 9                  | 9                  | 9                            | 9                                 |                |                 |                 |                   |                      |                        |                       |                         |                |                |                          |                              |                               |                              |                               |                               |                                 |                                    |                                      |                                     |                                       |                              |                              |                                        |                                            |                                             |
+-------------+-------------+---------------+------------+-----------+---------------------+---------------+------+------------+-------+-----------------+--------------------+----------+---------+------------+-------------+-------------+---------------+------------------+--------------------+-------------------+---------------------+------------+------------+----------------------+--------------------------+---------------------------+--------------------+---------------------+---------------------+-----------------------+--------------------------+----------------------------+---------------------------+-----------------------------+--------------------+--------------------+------------------------------+-----------------------------------+----------------+-----------------+-----------------+-------------------+----------------------+------------------------+-----------------------+-------------------------+----------------+----------------+--------------------------+------------------------------+-------------------------------+------------------------------+-------------------------------+-------------------------------+---------------------------------+------------------------------------+--------------------------------------+-------------------------------------+---------------------------------------+------------------------------+------------------------------+----------------------------------------+--------------------------------------------+---------------------------------------------+
| 141         | 10          | Off Peak      | 4          | 67        | Premium Rate Number | 32            |      | 2 per call | 32905 | PAY             | 44                 | 26       |         | 0.00000000 | 0.00000000  | 0.00000000  | 0.02340000    | 0.00000000       | 0.00000000         | 0.00000000        | 0.00000000          | 0.00000000 | 0.00000000 | 0.00000000           | 0.00000000               | 0.00000000                | 9                  | 9                   | 9                   | 9                     | 9                        | 9                          | 9                         | 9                           | 9                  | 9                  | 9                            | 9                                 |                |                 |                 |                   |                      |                        |                       |                         |                |                |                          |                              |                               |                              |                               |                               |                                 |                                    |                                      |                                     |                                       |                              |                              |                                        |                                            |                                             |
+-------------+-------------+---------------+------------+-----------+---------------------+---------------+------+------------+-------+-----------------+--------------------+----------+---------+------------+-------------+-------------+---------------+------------------+--------------------+-------------------+---------------------+------------+------------+----------------------+--------------------------+---------------------------+--------------------+---------------------+---------------------+-----------------------+--------------------------+----------------------------+---------------------------+-----------------------------+--------------------+--------------------+------------------------------+-----------------------------------+----------------+-----------------+-----------------+-------------------+----------------------+------------------------+-----------------------+-------------------------+----------------+----------------+--------------------------+------------------------------+-------------------------------+------------------------------+-------------------------------+-------------------------------+---------------------------------+------------------------------------+--------------------------------------+-------------------------------------+---------------------------------------+------------------------------+------------------------------+----------------------------------------+--------------------------------------------+---------------------------------------------+
| 141         | 13          | Peak          | 4          | 67        | Premium Rate Number | 32            |      | 2 per call | 32905 | PAY             | 44                 | 26       |         | 0.00000000 | 0.00000000  | 0.00000000  | 0.03560000    | 0.00000000       | 0.00000000         | 0.00000000        | 0.00000000          | 0.00000000 | 0.00000000 | 0.00000000           | 0.00000000               | 0.00000000                | 9                  | 9                   | 9                   | 9                     | 9                        | 9                          | 9                         | 9                           | 9                  | 9                  | 9                            | 9                                 |                |                 |                 |                   |                      |                        |                       |                         |                |                |                          |                              |                               |                              |                               |                               |                                 |                                    |                                      |                                     |                                       |                              |                              |                                        |                                            |                                             |
+-------------+-------------+---------------+------------+-----------+---------------------+---------------+------+------------+-------+-----------------+--------------------+----------+---------+------------+-------------+-------------+---------------+------------------+--------------------+-------------------+---------------------+------------+------------+----------------------+--------------------------+---------------------------+--------------------+---------------------+---------------------+-----------------------+--------------------------+----------------------------+---------------------------+-----------------------------+--------------------+--------------------+------------------------------+-----------------------------------+----------------+-----------------+-----------------+-------------------+----------------------+------------------------+-----------------------+-------------------------+----------------+----------------+--------------------------+------------------------------+-------------------------------+------------------------------+-------------------------------+-------------------------------+---------------------------------+------------------------------------+--------------------------------------+-------------------------------------+---------------------------------------+------------------------------+------------------------------+----------------------------------------+--------------------------------------------+---------------------------------------------+




